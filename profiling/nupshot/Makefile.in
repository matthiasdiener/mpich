#  (C) 1993 by Argonne National Laboratory and Mississipi State University.
#      All rights reserved.  See COPYRIGHT in top-level directory.
#

##### User configurable options #####

ARCH        = @ARCH@
BOPT        = @BOPT@
MPIR_HOME   = @MPIR_HOME@
CC          = @CC@
CLINKER     = @CLINKER@
INCLUDE_DIR = @INCLUDE_PATH@ @X_INC@ $(TCLTK_INC)
OPTFLAGS    = @OPTFLAGS@
LIB_PATH    = $(TCLTK_LIB) @X_LIB@
LIB_LIST    = -lX11 -lm

# It is easier if the tcl and tcl stuff is in the same directory,
# but if your installation has them in separate directories, so be it.

# Right now, TCLLIB and TKLIB can be specified as a command line option
# for configure, so we'll make do with what we can.

TCL_DIR     = @TCL_DIR@
#TCL_DIR     = /usr/local/tcl

TK_DIR      = @TK_DIR@
#TK_DIR      = /usr/local/tcl

TCL_LIB     = -L$(TCL_DIR)/lib -ltcl
#TCL_LIB      = -L@TCLLIB@ -ltcl
TK_LIB      = -L$(TK_DIR)/lib -ltk
#TK_LIB      = -ltk
TCLTK_LIB   = $(TCL_LIB) $(TK_LIB)

TCL_INC     = -I$(TCL_DIR)/include
TK_INC      = -I$(TK_DIR)/include

TCLTK_INC   = $(TCL_INC) $(TK_INC)


### End User configurable options ###
SHELL = /bin/sh

EXECS = nupshot

CFLAGS = @CFLAGS@ $(OPTFLAGS) $(INCLUDE_DIR) -DMPI_$(ARCH) $(MPE_GRAPH) \
	 "-DNUPSHOT_TCL_CODE=\"$(MPIR_HOME)/profiling/nupshot/nupshot.tcl\""

CSOURCES = alog.c bitmaps.c cvt_args.c events.c log.c log_common.c \
	   log_widget.c msgs.c states.c str_dup.c tclptr.c time_lbl.c \
	   timelines.c tkAppInit.c vis.c nupshot.c

COBJECTS = alog.o bitmaps.o cvt_args.o events.o log.o log_common.o \
	   log_widget.o msgs.o states.o str_dup.o tclptr.o time_lbl.o \
	   timelines.o tkAppInit.o vis.o nupshot.o

default: nupshot

.c.o:
	$(CC) $(CFLAGS) -c $*.c

.c.a:
	$(CC) $(CFLAGS) -c $*.c

nupshot: $(COBJECTS)
	$(CLINKER) -o nupshot $(COBJECTS) \
	$(LIB_PATH) $(LIB_LIST)
clean:
	/bin/rm -f *.o *~ $(EXECS)


#
# rcsid = $Header: /nfs/globus1/src/master/nexus_examples/ring/Makefile.in,v 1.4 1996/02/07 19:50:59 geisler Exp $
#

#######################################################################
# Pick one of the following machine configurations
#

# SunOS 4.1.x config
#NEXUS_DIR=/usr/local/iway/app/nexus/nexus
#CC=/usr/local/gcc-2.7.0/bin/gcc
#CC_LITE=$(CC)
#DEBUG_CFLAGS=-g
#OPT_CFLAGS=-O3
#OTHER_LIBS=-lgthreads -lmalloc
#OTHER_LIBS_LITE=

# SGI Irix 5.3 config
#NEXUS_DIR=/usr/local/iway/app/nexus/nexus
#CC=ncc
#CC_LITE=$(CC)
#DEBUG_CFLAGS=-g
#OPT_CFLAGS=-O
#OTHER_LIBS=-lqt
#OTHER_LIBS_LITE=

# IBM RS/6000 AIX 3.2.5
NEXUS_DIR=/usr/local/iway/app/nexus/nexus-3.0b2
CC=xlc_r
CC_LITE=xlc
DEBUG_CFLAGS=-g
OPT_CFLAGS=-O
OTHER_LIBS=
OTHER_LIBS_LITE=

#######################################################################
# Pick one of the following nexus configurations
# You should do a "make clean" if you change this.
#

# debugging
NEXUS_CFLAGS=$(DEBUG_CFLAGS) -DNEXUS_DEBUG
NEXUS_LIB=-lnexus_debug
NEXUS_CFLAGS_LITE=$(DEBUG_CFLAGS) -DNEXUS_DEBUG -DNEXUS_LITE
NEXUS_LIB_LITE=-lnexuslite_debug

#optimized
#NEXUS_CFLAGS=-$(OPT_CFLAGS)
#NEXUS_LIB=-lnexus_opt
#NEXUS_CFLAGS_LITE=-$(OPT_CFLAGS) -DNEXUS_LITE
#NEXUS_LIB_LITE=-lnexuslite_opt

#######################################################################
# And here's all the glue
#

NEXUS_INC_DIR=$(NEXUS_DIR)/include
NEXUS_LIB_DIR=$(NEXUS_DIR)/lib
NEXUS_BIN_DIR=$(NEXUS_DIR)/bin

CFLAGS=$(NEXUS_CFLAGS) -I$(NEXUS_INC_DIR)
LIBS=-L$(NEXUS_LIB_DIR) $(NEXUS_LIB) $(OTHER_LIBS)

CFLAGS_LITE=$(NEXUS_CFLAGS_LITE) -I$(NEXUS_INC_DIR)
LIBS_LITE=-L$(NEXUS_LIB_DIR) $(NEXUS_LIB_LITE) $(OTHER_LIBS_LITE)


default all:	ring ringmt


ring:	ring.o
	$(CC_LITE) $(CFLAGS_LITE) -o ring ring.o $(LIBS_LITE)

ring.o:	ring.c
	$(CC_LITE) $(CFLAGS_LITE) -c ring.c


ringmt:	ringmt.o
	$(CC) $(CFLAGS) -o ringmt ringmt.o $(LIBS)

ringmt.o:	ring.c
	rm -f ringmt.c
	ln -s ring.c ringmt.c
	$(CC) $(CFLAGS) -c ringmt.c


install:
	cp ring ringmt $(NEXUS_DIR)/bin/.


mostlyclean:
	rm -f *.o ring ringmt

clean:
	rm -f *.o *~ ring ringmt ringmt.c

#
# config.cache is normally built in ../../, but put it here just to be
# safe
#
XTRA_FILES=config.cache \
	   config.log \
	   config.status \
	   Makefile

distclean: clean
	rm -f $(XTRA_FILES)
